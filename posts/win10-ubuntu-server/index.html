<!doctype html>
<html lang="en">
<head>
  <meta charSet="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <title>Install Ubuntu Server on Windows 10 PC</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css" type="text/css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flexboxgrid/6.3.1/flexboxgrid.min.css" type="text/css" />
  <link rel="shortcut icon" href="/favicon.ico" />
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      max-width: 1000px;
      margin: 0 auto;
      padding-left: 20px;
      padding-right: 20px;
      color: #333;
    }
    a {
      color: inherit;
      text-decoration: none;
    }
    header {
      margin-top: 1em;
    }
    header h1 {
      font-size: 2em;
    }
    .sidebar {
      font-size: 1.5em;
    }
    .sidebar ul {
      border: 1px #333;
      border-left-style: solid;
      padding-left: 1em;
    }
    .sidebar li {
      margin-bottom: .5em;
    }
    .breadcrumb-nav {
      margin-top: 1em;
    }
    .the-article {
      margin-top: 1em;
      font-size: 1.2em;
    }
    .the-article h1 {
      font-size: 1.4em;
      font-weight: bold;
    }
    .the-article h2 {
      font-size: 1.1em;
      font-weight: bold;
    }
    .the-article h3 {
      font-weight: bold;
      text-transform: uppercase;
    }
    .the-article h3 {
      font-weight: bold;
    }
    .the-article>* {
      margin-bottom: 1em;
    }
    .the-article p {
      line-height: 1.2em;
    }
    .the-article a {
      text-decoration: underline;
    }
    table td {
      border: 1px solid #333;
      padding: 4px;
    }
    pre, code, tt {
      font-family: "Jetbrains Mono", SFMono-Regular, Menlo, Consolas, monospace;
      font-size: .9em;
      background: #343434;
      border-radius: 5px;
      color: #fff;
    }
    pre {
      white-space: pre-line;
      padding: 10px;
      line-height: 1.2em;
    }
    code {
      padding: 0 3px;
      border-radius: 3px;
    }
    pre>code {
      font-size: inherit;
      padding: 0px;
    }
    ul {
      list-style-type: disc;
      padding-left: 1.5em;
      line-height: 1.2em;
    }
  </style>
</head>
<body>
  <header>
    <div class="row">
      <div class="col-xs-12">
        <h1>
          <a href="/">Kavin Yao</a>
        </h1>
      </div>
    </div>
  </header>

  <section id="main">
    <div class="row">
      <div class="breadcrumb-nav col-xs-12">
        <a href="/">&#x2190; Back</a>
      </div>
    </div>
    <div class="row">
      <div class="the-article col-xs-12">
        <h1>Install Ubuntu Server on Windows 10 PC</h1>

        
        <p>I've been having lots of fun with home networking recently. Now that I'm in the rabbit hole I've reached the stage of needing a dedicated home server. For now the server will only run an nginx server as reverse proxy. Before I splurge on a new server, I want to see if I can repurpose any existing hardware for this â€“ and my eyes fell on the <a href="/nuc">NUC</a>, which is supposed to be the living room PC but it's not getting used at all sitting in the living room. Since I <em>may</em> actually use it for entertainment in the future and this is an experiment I don't want to fully convert it to a Linux box so I want to have dual boot so I can still switch back to Windows 10 when I need. I chose the good old Ubuntu Linux distro, specifically 20.04 LTS server version. I chose server because of the much smaller footprint compared to desktop version (and CLI is just way cooler than GUI). As it turns out the installation of Ubuntu server isn't as dummy proof as desktop so the journey wasn't as smooth as expected. Here's the steps I <strike>took</strike> should have taken, just for posterity.</p>

<h2>Preparation</h2>

<p>First, you need to allocate some disk space for Ubuntu server, specifically a partition Ubuntu can use to mount as root. I used Windows Disk Manager to shrink one partition by 30GB to create free space and <a href="https://www.minitool.com/partition-manager/">MiniTool</a> free version to create an ext4 partition. Formatting to ext4 is important as the server installation tool doesn't offer you the ability to create partition on the fly, unlike the desktop version. Specific parameters don't matter as the partition will be reformatted during the installation.</p>

<p>Next, create a bootable USB stick. Just follow <a href="https://ubuntu.com/tutorials/create-a-usb-stick-on-windows">the official guide</a>.</p>

<p>Finally, turn off Secure Boot from BIOS. According to Internet, if Secure Boot is on, dual boot doesn't work.</p>

<h2>Installation</h2>

<p>Plug in the USB stick and boot from it. Again, I mostly followed <a href="https://ubuntu.com/tutorials/install-ubuntu-server">the official guide</a>. The only thing to pay attention to is in the "Configure Storage" step, make sure you select the option other than "Use An Entire Disk" as that'll erase Windows and in the next step select the new ext4 partition you just created, format as ext4 (again) and mount it to <code>/</code>. Check out this <a href="https://imgur.com/a/hYxdxVj">imgur album</a> for demo. After that, continue the installation it should complete installation and set grub as the default UEFI boot device.</p>

<h2>Post Installation</h2>

<p>It may happen if you boot to Windows 10, Windows Boot Manager will override grub and next boot will load Windows directly. There are multiple ways to fix this but the simplest solution i found is to follow <a href="https://askubuntu.com/a/655279/1112741">this guide</a>:</p>

<ul>
<li>open an admin command line in Windows 10</li>
<li>run <code>bcdedit /enum firmware</code></li>
<li>note down the grub EFI path</li>
<li>run <code>bcdedit /set {bootmgr} path &lt;&lt;insert_path&gt;&gt;</code> (the path was <code>\EFI\ubuntu\shimx64.efi</code> in my case)</li>
</ul>

<p>After that Windows Boot Manager will boot with grub.</p>

        
      </div>
    </div>
  </section>
  <footer>
  </footer>
</body>
</html>